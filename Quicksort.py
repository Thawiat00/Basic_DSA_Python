# ========================================
# Part 16: QUICKSORT (‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß)
# ========================================

def partition(array, low, high):
    """
    ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
    - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å pivot (‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢)
    - ‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ã‡πâ‡∏≤‡∏¢ ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏ß‡∏≤
    - ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ index ‡∏Ç‡∏≠‡∏á pivot ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
    """
    pivot = array[high]  # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô pivot
    i = low - 1  # ‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ pivot
    
    # ‡∏ß‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ pivot
    for j in range(low, high):
        if array[j] <= pivot:
            i += 1
            # ‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
            array[i], array[j] = array[j], array[i]
    
    # ‡∏ß‡∏≤‡∏á pivot ‡πÑ‡∏ß‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
    array[i + 1], array[high] = array[high], array[i + 1]
    return i + 1


def quicksort(array, low=0, high=None):
    """
    ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Quicksort ‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ä‡πâ Recursion)
    """
    if high is None:
        high = len(array) - 1
    
    if low < high:
        # ‡∏´‡∏≤ pivot index
        pivot_index = partition(array, low, high)
        
        # ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏ß‡∏≤‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô (Recursion)
        quicksort(array, low, pivot_index - 1)   # ‡∏ã‡πâ‡∏≤‡∏¢
        quicksort(array, pivot_index + 1, high)  # ‡∏Ç‡∏ß‡∏≤


# ========================================
# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î
# ========================================

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 1: Array ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤
print("=" * 50)
print("‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 1: Quicksort ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô")
print("=" * 50)
mylist1 = [64, 34, 25, 5, 22, 11, 90, 12]
print(f"‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist1}")
quicksort(mylist1)
print(f"‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist1}")

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 2: ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πâ‡∏≥
print("\n" + "=" * 50)
print("‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 2: ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πâ‡∏≥")
print("=" * 50)
mylist2 = [3, 7, 3, 1, 3, 2, 7]
print(f"‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist2}")
quicksort(mylist2)
print(f"‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist2}")

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô
print("\n" + "=" * 50)
print("‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 3: Array ‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô")
print("=" * 50)
mylist3 = [50, 40, 30, 20, 10]
print(f"‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist3}")
quicksort(mylist3)
print(f"‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist3}")

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 4: ‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏•‡∏ö
print("\n" + "=" * 50)
print("‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà 4: ‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡∏•‡∏ö")
print("=" * 50)
mylist4 = [-5, 10, -3, 0, 8, -1]
print(f"‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist4}")
quicksort(mylist4)
print(f"‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏á: {mylist4}")

print("\n‚úÖ Quicksort ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå!")
print("üìä Time Complexity:")
print("   - Average: O(n log n)")
print("   - Worst: O(n¬≤)")